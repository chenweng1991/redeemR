% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/convert_format.R
\name{convert_redeem_matrix_long}
\alias{convert_redeem_matrix_long}
\title{Convert a redeemR variant & depth matrix into long format for downstream analysis}
\usage{
convert_redeem_matrix_long(sample = "", mat_var, mat_depth, cell_whitelist)
}
\arguments{
\item{sample}{Character; an identifier for this dataset (printed to the console).}

\item{mat_var}{A numeric matrix of variant UMI counts (cells × variants).}

\item{mat_depth}{A numeric matrix of total depth (same dimensions and row/column names as \code{mat_var}).}

\item{cell_whitelist}{A character vector of cell barcodes to retain (rows of \code{mat_var}/\code{mat_depth}).}
}
\value{
A \code{data.table} with columns:
\itemize{
\item \code{cell}: cell barcode
\item \code{variant}: variant identifier
\item \code{a}: UMI count (filtered)
\item \code{d}: corresponding depth
}
}
\description{
This function filters a variant count matrix (\code{mat_var}) to include only cells in the provided
whitelist and variants observed in at least two cells, applies the same filtering to the corresponding
depth matrix (\code{mat_depth}), and then melts both into a single long-format \code{data.table}.  The output
contains one row per cell–variant pair with its count (\code{a}) and depth (\code{d}).
}
\details{
Included in redeemR-2.0  2025-07-01
\enumerate{
\item Retains only rows in \code{mat_var} whose rownames appear in \code{cell_whitelist}.
\item Drops variants observed in fewer than two cells.
\item Ensures both matrices share the same dimensions before melting.
\item Returns a combined long table for joint count/depth analysis.
}
}
